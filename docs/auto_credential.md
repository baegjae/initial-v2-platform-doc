Auto Credential Issue
================

**Faber**(Issuer/Verifier)와 **Alice**(Holder/Prover)의 연결 및 VC발급/검증 예제를 통한 API 설명
<br>
Connection State

Topic | State | Description
--- | --- | ---
issue_credential | offer_sent | (faber)credential offer 한 상태
issue_credential | offer_received | (alice)offer를 받은 상태
issue_credential | request_sent | (alice) credential을 요청 한 상태
issue_credential | request_received | (faber) Credential 요청을 받은 상태 
issue_credential | credential_issued | (faber) Credential을 issue  
issue_credential | credential_received | (alice) Credential을 받은 상태 
issue_credential | credential_acked | (alice/faber) Credential 수취 완


### STEP 1. Faber --> Alice : Alice에게 Credential offer를 요청한다. 

* Method and Resource

    `POST` `/issue-credential​/send-offer` credential preview를 보내면서 offer.  

* Parameter

 Name | Description 
 --- | --- 
 body | Schema String 
 auto_issue | Alice가 credential request를 하면 자동으로 issue 완료<br>`/issue-credential/records/{cred_ex_id}/issue` 자동 처리
 auto_remove | Credential issue 완료되면 cred_ex_id record를 자동 삭제 <br> `/issue-credential/records/{cred_ex_id}/remove` 자동 처리 
 
<p></p>

* Example

    * input <br>
    `connection_id` : `string`<br>
    `attribute` : `list string`<br>
    `cred_def_id` : `string`<br>

    * body
```json
{
  "connection_id": "ce737f4c-3065-4da5-a490-98568fc3a773",
  "trace": false,
  "credential_preview": {
    "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/credential-preview",
    "attributes": [
      {"name": "name", "value": "alice"}, 
      {"name": "date", "value": "08-2018"},
      {"name": "degree", "value": "maths"},
      {"name": "age", "value": "25"}
    ]
  },
  "auto_issue": true,
  "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college",
  "auto_remove": true,
  "comment": "string"
}
```

<p></p>
 
   * Response body
```json
{
  "credential_definition_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college",
  "trace": false,
  "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
  "thread_id": "5a5eb7f2-efec-4319-9265-1a304f62fc1c",
  "credential_proposal_dict": {
    "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/propose-credential",
    "@id": "44b6a5b8-a590-4bcc-9440-b5023c9556f7",
    "credential_proposal": {
      "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/credential-preview",
      "attributes": [
        {
          "name": "name",
          "value": "alice"
        },
        {
          "name": "date",
          "value": "08-2018"
        },
        {
          "name": "degree",
          "value": "maths"
        },
        {
          "name": "age",
          "value": "25"
        }
      ]
    },
    "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college",
    "comment": "string"
  },
  "updated_at": "2020-08-24 07:08:56.034090Z",
  "state": "offer_sent",
  "connection_id": "ce737f4c-3065-4da5-a490-98568fc3a773",
  "auto_issue": true,
  "auto_remove": true,
  "initiator": "self",
  "created_at": "2020-08-24 07:08:56.034090Z",
  "auto_offer": false,
  "credential_offer": {
    "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
    "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college",
    "key_correctness_proof": {
      "c": "1211877137352975463375244041700762417669628883094972980895062156226939594402",
      "xz_cap": "8115961514951812893019986223806866549524800875222674020819102495317582554707787440890847512164570050499140328724066359393524473039011310822575988360212058249011303025364927630306619639110090525647691013216404933458972973757324041910370972393348643439014381883537062076109476281533684079455056302022851203835166723040738610436456284853031488359745157917893874501698898620950357501750167791549863227035443558972787057489897135694495443263261231745249189026514606484118086509953367288902932736010808047145837780042232749595367491270654192839550655436662552365992872857372110965151191864165689047380962401251959398562959598596362667071587105859657891413523696717336765379185330665654916650216821",
      "xr_cap": [
        [
          "date",
          "33707859903081596188568324249725258543758458986207800463376651085096562554922818421232375486850302551555596664182852645285121968565909363837536111960227440017926587517104148607126442832105626813228504702527033626905478442067885586189706946533205293763702112054063046969349575823588577663075128920478993457405091963398088428490107167750576986934713442091205260529153597081471329551174363260912629846034195234008690789516396618444419611169470644668334218238518205064185487105177831198589625036929423822532554912318768192851904186578918402071091714900014042486279852690495876883908105724334215542859581004573900466741396523850791747351248163990721139768028556530617653324410890820711424830252340"
        ],
        [
          "master_secret",
          "21316669012664687319369248784598613730811052868099133401118752407582680150321161172633069205928479940145205890110674749991811847910687389520806101718665836012747969692113139643354501142700040489753326389921743858095616658979003572830343489665883575039480966878967569668891071229892991265881773195459999847621870782573588569960415929964902537869700232595160110730740225031770266573841343083758300276561438322842955503195778194030527744135691421625837828697234509007680111495549692336776653968890253564735921992281463127269130234247691344838644718116563844401840096408607320963729816150141205369777132798240918560151156620692042233842747168319561367835465734043635278535596645170273266651067354"
        ],
        [
          "degree",
          "32808350207909552000663769297428169906618718163752958299644864084198452324903653796103113267876821046310308274799929948822418741373992201343897949446061310789850587971301658151163692409244117594395244580844562766845849162535907880576337873622850357285846651115223417058267736144392508911367400339474812142768155878946867599302163956510663073145158154154471677185496324498384600910952528680219720874849255800023338669375164764501697507912320094017869912244417481642697674701469444157089813313232458745050745264124936932369322262874558153766798785790164688390965478024061533952490595314500169665208987515361044381127816263258281539988702671420428334413060199609960859059343694577591630948587557"
        ],
        [
          "name",
          "20394974789044082970541152955606572103461567728315829879381808717600421177744248635001385287010990031623026194822353092019613141430116596863878694023954099289187492902390535929653703097419404579137774631859241008672464329349626872154122310133280890862920531608780818629839689154706863780304112909252628756488092736234521949044509862165338438153103693977957134371048419499875347525353826666174889746746555907532164909278718231299368326261765846445616641758988577740151666194588257659450372094731058922976059931011909679868933083490345969958081572447120711547715449228751861811720192505120436604210676732030927784341861241008138909147570234499026644058423983959063173524450034277367859431304074"
        ],
        [
          "age",
          "12978383263696483579058528130178872284099728061983709986093745341385478818028463441116127444391324282828038361793245505751234964066473209353926429859942340059659452746878796562145765306236576059897863703112351705209095966460901176231047488026736546869621099393390353067470258360965780961086876508404727152292034936453127347056311090706223633486982380930089009642249818235821148708681287215415353758665701921158903681394116087492563096728978179355692830437496770368817085503849637689427788431657412454146824974437263001626025074741468648880355602470058488204464186826891543902078600881565122082389091528945986689054728016751936614042206171653669126382022427118458116005224449432328568366024314"
        ]
      ]
    },
    "nonce": "91199357596350999096630"
  },
  "credential_offer_dict": {
    "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/offer-credential",
    "@id": "5a5eb7f2-efec-4319-9265-1a304f62fc1c",
    "~thread": {},
    "offers~attach": [
      {
        "@id": "libindy-cred-offer-0",
        "mime-type": "application/json",
        "data": {
          "base64": "eyJzY2hlbWFfaWQiOiAiVGg3TXBUYVJaVlJZblBpYWJkczgxWToyOmRlZ3JlZV9zY2hlbWE6MjQuOC4xIiwgImNyZWRfZGVmX2lkIjogIlRoN01wVGFSWlZSWW5QaWFiZHM4MVk6MzpDTDoyMTQzOmZhYmVyX2NvbGxlZ2UiLCAia2V5X2NvcnJlY3RuZXNzX3Byb29mIjogeyJjIjogIjEyMTE4NzcxMzczNTI5NzU0NjMzNzUyNDQwNDE3MDA3NjI0MTc2Njk2Mjg4ODMwOTQ5NzI5ODA4OTUwNjIxNTYyMjY5Mzk1OTQ0MDIiLCAieHpfY2FwIjogIjgxMTU5NjE1MTQ5NTE4MTI4OTMwMTk5ODYyMjM4MDY4NjY1NDk1MjQ4MDA4NzUyMjI2NzQwMjA4MTkxMDI0OTUzMTc1ODI1NTQ3MDc3ODc0NDA4OTA4NDc1MTIxNjQ1NzAwNTA0OTkxNDAzMjg3MjQwNjYzNTkzOTM1MjQ0NzMwMzkwMTEzMTA4MjI1NzU5ODgzNjAyMTIwNTgyNDkwMTEzMDMwMjUzNjQ5Mjc2MzAzMDY2MTk2MzkxMTAwOTA1MjU2NDc2OTEwMTMyMTY0MDQ5MzM0NTg5NzI5NzM3NTczMjQwNDE5MTAzNzA5NzIzOTMzNDg2NDM0MzkwMTQzODE4ODM1MzcwNjIwNzYxMDk0NzYyODE1MzM2ODQwNzk0NTUwNTYzMDIwMjI4NTEyMDM4MzUxNjY3MjMwNDA3Mzg2MTA0MzY0NTYyODQ4NTMwMzE0ODgzNTk3NDUxNTc5MTc4OTM4NzQ1MDE2OTg4OTg2MjA5NTAzNTc1MDE3NTAxNjc3OTE1NDk4NjMyMjcwMzU0NDM1NTg5NzI3ODcwNTc0ODk4OTcxMzU2OTQ0OTU0NDMyNjMyNjEyMzE3NDUyNDkxODkwMjY1MTQ2MDY0ODQxMTgwODY1MDk5NTMzNjcyODg5MDI5MzI3MzYwMTA4MDgwNDcxNDU4Mzc3ODAwNDIyMzI3NDk1OTUzNjc0OTEyNzA2NTQxOTI4Mzk1NTA2NTU0MzY2NjI1NTIzNjU5OTI4NzI4NTczNzIxMTA5NjUxNTExOTE4NjQxNjU2ODkwNDczODA5NjI0MDEyNTE5NTkzOTg1NjI5NTk1OTg1OTYzNjI2NjcwNzE1ODcxMDU4NTk2NTc4OTE0MTM1MjM2OTY3MTczMzY3NjUzNzkxODUzMzA2NjU2NTQ5MTY2NTAyMTY4MjEiLCAieHJfY2FwIjogW1siZGF0ZSIsICIzMzcwNzg1OTkwMzA4MTU5NjE4ODU2ODMyNDI0OTcyNTI1ODU0Mzc1ODQ1ODk4NjIwNzgwMDQ2MzM3NjY1MTA4NTA5NjU2MjU1NDkyMjgxODQyMTIzMjM3NTQ4Njg1MDMwMjU1MTU1NTU5NjY2NDE4Mjg1MjY0NTI4NTEyMTk2ODU2NTkwOTM2MzgzNzUzNjExMTk2MDIyNzQ0MDAxNzkyNjU4NzUxNzEwNDE0ODYwNzEyNjQ0MjgzMjEwNTYyNjgxMzIyODUwNDcwMjUyNzAzMzYyNjkwNTQ3ODQ0MjA2Nzg4NTU4NjE4OTcwNjk0NjUzMzIwNTI5Mzc2MzcwMjExMjA1NDA2MzA0Njk2OTM0OTU3NTgyMzU4ODU3NzY2MzA3NTEyODkyMDQ3ODk5MzQ1NzQwNTA5MTk2MzM5ODA4ODQyODQ5MDEwNzE2Nzc1MDU3Njk4NjkzNDcxMzQ0MjA5MTIwNTI2MDUyOTE1MzU5NzA4MTQ3MTMyOTU1MTE3NDM2MzI2MDkxMjYyOTg0NjAzNDE5NTIzNDAwODY5MDc4OTUxNjM5NjYxODQ0NDQxOTYxMTE2OTQ3MDY0NDY2ODMzNDIxODIzODUxODIwNTA2NDE4NTQ4NzEwNTE3NzgzMTE5ODU4OTYyNTAzNjkyOTQyMzgyMjUzMjU1NDkxMjMxODc2ODE5Mjg1MTkwNDE4NjU3ODkxODQwMjA3MTA5MTcxNDkwMDAxNDA0MjQ4NjI3OTg1MjY5MDQ5NTg3Njg4MzkwODEwNTcyNDMzNDIxNTU0Mjg1OTU4MTAwNDU3MzkwMDQ2Njc0MTM5NjUyMzg1MDc5MTc0NzM1MTI0ODE2Mzk5MDcyMTEzOTc2ODAyODU1NjUzMDYxNzY1MzMyNDQxMDg5MDgyMDcxMTQyNDgzMDI1MjM0MCJdLCBbIm1hc3Rlcl9zZWNyZXQiLCAiMjEzMTY2NjkwMTI2NjQ2ODczMTkzNjkyNDg3ODQ1OTg2MTM3MzA4MTEwNTI4NjgwOTkxMzM0MDExMTg3NTI0MDc1ODI2ODAxNTAzMjExNjExNzI2MzMwNjkyMDU5Mjg0Nzk5NDAxNDUyMDU4OTAxMTA2NzQ3NDk5OTE4MTE4NDc5MTA2ODczODk1MjA4MDYxMDE3MTg2NjU4MzYwMTI3NDc5Njk2OTIxMTMxMzk2NDMzNTQ1MDExNDI3MDAwNDA0ODk3NTMzMjYzODk5MjE3NDM4NTgwOTU2MTY2NTg5NzkwMDM1NzI4MzAzNDM0ODk2NjU4ODM1NzUwMzk0ODA5NjY4Nzg5Njc1Njk2Njg4OTEwNzEyMjk4OTI5OTEyNjU4ODE3NzMxOTU0NTk5OTk4NDc2MjE4NzA3ODI1NzM1ODg1Njk5NjA0MTU5Mjk5NjQ5MDI1Mzc4Njk3MDAyMzI1OTUxNjAxMTA3MzA3NDAyMjUwMzE3NzAyNjY1NzM4NDEzNDMwODM3NTgzMDAyNzY1NjE0MzgzMjI4NDI5NTU1MDMxOTU3NzgxOTQwMzA1Mjc3NDQxMzU2OTE0MjE2MjU4Mzc4Mjg2OTcyMzQ1MDkwMDc2ODAxMTE0OTU1NDk2OTIzMzY3NzY2NTM5Njg4OTAyNTM1NjQ3MzU5MjE5OTIyODE0NjMxMjcyNjkxMzAyMzQyNDc2OTEzNDQ4Mzg2NDQ3MTgxMTY1NjM4NDQ0MDE4NDAwOTY0MDg2MDczMjA5NjM3Mjk4MTYxNTAxNDEyMDUzNjk3NzcxMzI3OTgyNDA5MTg1NjAxNTExNTY2MjA2OTIwNDIyMzM4NDI3NDcxNjgzMTk1NjEzNjc4MzU0NjU3MzQwNDM2MzUyNzg1MzU1OTY2NDUxNzAyNzMyNjY2NTEwNjczNTQiXSwgWyJkZWdyZWUiLCAiMzI4MDgzNTAyMDc5MDk1NTIwMDA2NjM3NjkyOTc0MjgxNjk5MDY2MTg3MTgxNjM3NTI5NTgyOTk2NDQ4NjQwODQxOTg0NTIzMjQ5MDM2NTM3OTYxMDMxMTMyNjc4NzY4MjEwNDYzMTAzMDgyNzQ3OTk5Mjk5NDg4MjI0MTg3NDEzNzM5OTIyMDEzNDM4OTc5NDk0NDYwNjEzMTA3ODk4NTA1ODc5NzEzMDE2NTgxNTExNjM2OTI0MDkyNDQxMTc1OTQzOTUyNDQ1ODA4NDQ1NjI3NjY4NDU4NDkxNjI1MzU5MDc4ODA1NzYzMzc4NzM2MjI4NTAzNTcyODU4NDY2NTExMTUyMjM0MTcwNTgyNjc3MzYxNDQzOTI1MDg5MTEzNjc0MDAzMzk0NzQ4MTIxNDI3NjgxNTU4Nzg5NDY4Njc1OTkzMDIxNjM5NTY1MTA2NjMwNzMxNDUxNTgxNTQxNTQ0NzE2NzcxODU0OTYzMjQ0OTgzODQ2MDA5MTA5NTI1Mjg2ODAyMTk3MjA4NzQ4NDkyNTU4MDAwMjMzMzg2NjkzNzUxNjQ3NjQ1MDE2OTc1MDc5MTIzMjAwOTQwMTc4Njk5MTIyNDQ0MTc0ODE2NDI2OTc2NzQ3MDE0Njk0NDQxNTcwODk4MTMzMTMyMzI0NTg3NDUwNTA3NDUyNjQxMjQ5MzY5MzIzNjkzMjIyNjI4NzQ1NTgxNTM3NjY3OTg3ODU3OTAxNjQ2ODgzOTA5NjU0NzgwMjQwNjE1MzM5NTI0OTA1OTUzMTQ1MDAxNjk2NjUyMDg5ODc1MTUzNjEwNDQzODExMjc4MTYyNjMyNTgyODE1Mzk5ODg3MDI2NzE0MjA0MjgzMzQ0MTMwNjAxOTk2MDk5NjA4NTkwNTkzNDM2OTQ1Nzc1OTE2MzA5NDg1ODc1NTciXSwgWyJuYW1lIiwgIjIwMzk0OTc0Nzg5MDQ0MDgyOTcwNTQxMTUyOTU1NjA2NTcyMTAzNDYxNTY3NzI4MzE1ODI5ODc5MzgxODA4NzE3NjAwNDIxMTc3NzQ0MjQ4NjM1MDAxMzg1Mjg3MDEwOTkwMDMxNjIzMDI2MTk0ODIyMzUzMDkyMDE5NjEzMTQxNDMwMTE2NTk2ODYzODc4Njk0MDIzOTU0MDk5Mjg5MTg3NDkyOTAyMzkwNTM1OTI5NjUzNzAzMDk3NDE5NDA0NTc5MTM3Nzc0NjMxODU5MjQxMDA4NjcyNDY0MzI5MzQ5NjI2ODcyMTU0MTIyMzEwMTMzMjgwODkwODYyOTIwNTMxNjA4NzgwODE4NjI5ODM5Njg5MTU0NzA2ODYzNzgwMzA0MTEyOTA5MjUyNjI4NzU2NDg4MDkyNzM2MjM0NTIxOTQ5MDQ0NTA5ODYyMTY1MzM4NDM4MTUzMTAzNjkzOTc3OTU3MTM0MzcxMDQ4NDE5NDk5ODc1MzQ3NTI1MzUzODI2NjY2MTc0ODg5NzQ2NzQ2NTU1OTA3NTMyMTY0OTA5Mjc4NzE4MjMxMjk5MzY4MzI2MjYxNzY1ODQ2NDQ1NjE2NjQxNzU4OTg4NTc3NzQwMTUxNjY2MTk0NTg4MjU3NjU5NDUwMzcyMDk0NzMxMDU4OTIyOTc2MDU5OTMxMDExOTA5Njc5ODY4OTMzMDgzNDkwMzQ1OTY5OTU4MDgxNTcyNDQ3MTIwNzExNTQ3NzE1NDQ5MjI4NzUxODYxODExNzIwMTkyNTA1MTIwNDM2NjA0MjEwNjc2NzMyMDMwOTI3Nzg0MzQxODYxMjQxMDA4MTM4OTA5MTQ3NTcwMjM0NDk5MDI2NjQ0MDU4NDIzOTgzOTU5MDYzMTczNTI0NDUwMDM0Mjc3MzY3ODU5NDMxMzA0MDc0Il0sIFsiYWdlIiwgIjEyOTc4MzgzMjYzNjk2NDgzNTc5MDU4NTI4MTMwMTc4ODcyMjg0MDk5NzI4MDYxOTgzNzA5OTg2MDkzNzQ1MzQxMzg1NDc4ODE4MDI4NDYzNDQxMTE2MTI3NDQ0MzkxMzI0MjgyODI4MDM4MzYxNzkzMjQ1NTA1NzUxMjM0OTY0MDY2NDczMjA5MzUzOTI2NDI5ODU5OTQyMzQwMDU5NjU5NDUyNzQ2ODc4Nzk2NTYyMTQ1NzY1MzA2MjM2NTc2MDU5ODk3ODYzNzAzMTEyMzUxNzA1MjA5MDk1OTY2NDYwOTAxMTc2MjMxMDQ3NDg4MDI2NzM2NTQ2ODY5NjIxMDk5MzkzMzkwMzUzMDY3NDcwMjU4MzYwOTY1NzgwOTYxMDg2ODc2NTA4NDA0NzI3MTUyMjkyMDM0OTM2NDUzMTI3MzQ3MDU2MzExMDkwNzA2MjIzNjMzNDg2OTgyMzgwOTMwMDg5MDA5NjQyMjQ5ODE4MjM1ODIxMTQ4NzA4NjgxMjg3MjE1NDE1MzUzNzU4NjY1NzAxOTIxMTU4OTAzNjgxMzk0MTE2MDg3NDkyNTYzMDk2NzI4OTc4MTc5MzU1NjkyODMwNDM3NDk2NzcwMzY4ODE3MDg1NTAzODQ5NjM3Njg5NDI3Nzg4NDMxNjU3NDEyNDU0MTQ2ODI0OTc0NDM3MjYzMDAxNjI2MDI1MDc0NzQxNDY4NjQ4ODgwMzU1NjAyNDcwMDU4NDg4MjA0NDY0MTg2ODI2ODkxNTQzOTAyMDc4NjAwODgxNTY1MTIyMDgyMzg5MDkxNTI4OTQ1OTg2Njg5MDU0NzI4MDE2NzUxOTM2NjE0MDQyMjA2MTcxNjUzNjY5MTI2MzgyMDIyNDI3MTE4NDU4MTE2MDA1MjI0NDQ5NDMyMzI4NTY4MzY2MDI0MzE0Il1dfSwgIm5vbmNlIjogIjkxMTk5MzU3NTk2MzUwOTk5MDk2NjMwIn0="
        }
      }
    ],
    "credential_preview": {
      "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/credential-preview",
      "attributes": [
        {
          "name": "name",
          "value": "alice"
        },
        {
          "name": "date",
          "value": "08-2018"
        },
        {
          "name": "degree",
          "value": "maths"
        },
        {
          "name": "age",
          "value": "25"
        }
      ]
    },
    "comment": "string"
  },
  "credential_exchange_id": "412de146-5833-4fcc-be92-dbf5d50ba8ab"
}
```

<p></p>

* issue_credential State check 

    |  | Faber | Alice |
    | --- | --- | --- |
    | issue_credential state | **`offer_sent`** | N/A |
<p></p>


* Next Step
<br> Push Notification/Webhook등으로 Alice에게 전달. 
<br> Alice의 `/issue-credential/records/{cred_ex_id}/send-request` send request를 waiting.
<p></p>

* Ledger Transactions (Indy Node)

    
<br><br>

### STEP 2. Alice : Faber의 Credential offer를 확인. 

* Method and Resource

    `GET` `/issue-credential/records` cred_ex_id를 모를 경우. 모든 credential exchange records 가져와서 state가 `offer_received` 항목을 확인.   
    `GET` `/issue-credential/records/{cred_ex_id}` webhook 혹은 push를 통해 cred_ex_id를 알고 있을 경우.

* Parameter

 Name | Description 
 --- | --- 
 cred_ex_id | Faber의 Credential offer로 부터 받은 `credential_exchange_id`
 
<p></p>

* Example

    * input <br>
    `credential_exchange_id`: "585d064e-f3b0-4aca-8765-867c4d9ca4fd"

<p></p>
 
   * Response body
```json
{
  "initiator": "external",
  "credential_offer": {
    "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
    "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
    "key_correctness_proof": {
      "c": "3463285366096097786129141568913605545219935328983248399056642450653989015708",
      "xz_cap": "2156435992085141195304355154183203863089845854021318424499022392336865243688692057302909482720023495834702073088361890916122840670431178047835929829611993390203302843133181259690132294638300162614121697769368634189768854120738173439723594226861264872175339261848875411970910898341837820752346436364373531192136655177008411942372668401941695332807033823963769849927808053221157593980079803944993578674424570299145141161779824639243116104645988100070683676384331305227049466900308310967731275947115393934812802442376671012683818443728453322796095319749786251287360885746970984960326258055873871842421009484074526039822185567858544054167437327492571057285741123786278560194348431462522730865934",
      "xr_cap": [
        [
          "date",
          "64361899676791339851685248745784902380337936170464404822953058285320912128697720104954659823958477314424970570565179160802328430523685246844357360808328529069385786907148139607519911401719304017800868317832482552035687169890042769386612105961224271628979281234989183645437523364812314945489937064492061065473495108956420908328188426003118254064953870046372568469136133496903533692715155121651645510185788052552108783467207542888031078176809595884192230937384236205264203037786832149473399931710252353031834768200168550433227708768511986839415646813731687398595522924918260579882929695332079934325630076411249340620325018686667491128040840759590791875892498239333349119184853414563367749386080"
        ],
        [
          "master_secret",
          "57758980020326025908069841487884534897150916956949366950425931404585375709939254348573651816278007720536720176904400455848662923012130542787607130480933753737773497741218682069506339039035103907188554627743131124678560217216905085916119022480271693555004394233025092041755030710853731340823336071862836843523816553552314359407934883020634389621875902709813523533954905530528399385220514572524071495755840174452699845141764616847439245030380530505843087476916932612491870825361487128849871052932963451309471887149097976552486875216265025345183302240105085813743741674298967605499837711726001776562131271041881508199660713299149726396550354257783923816219781260861476172486234036043225928816640"
        ],
        [
          "age",
          "58244994491637067714559394147137024855939387441851436967050926493639474741008222576725413688107490467589881739933583301730711268702845749145288495021884158003818944638670629965254049646948179793550978929801428308096899998739225485032599101183006345499337064042075062477665835007614366373920000573066485633337418691595378631728786678141329570889993636187086927471316451360832816361450744937180869267302317943309769974473111281401477646025364853543734149415778056598400231642079049625682587366697170590640678863001480183092137539000773171341355471043390805292489073805654798603604433397335418099471137574479984440056041135360449811461867870137409083357749668374792724481814307989975597611855503"
        ],
        [
          "degree",
          "10261121300918485232883171219138364102745035394662318484553248676247944386794247169843748643619729634537314210977932713078478321434973436435580079541916446320120077885876279896160051138278797525262011036304470107207204733305213179844999873533217296491673229384690013976460861809965098708847327862385363280146217847262560843835216642860122302486164762469724837735515023956212445978460534404136751680072542982446415900998747260646066494126620616752541296372598961519435188337728291927352986051671072442700986800155164247816430896934401846120175427534504602608116398812965657401803452745608619220631366754225379286637850390579654473569063914715913134398892525665826264024216134417750114735195235"
        ],
        [
          "name",
          "72839154503524173467809293575026491898057315148644876607939528580314339830354540875760810569564273712993649853474615974411150602209216207947469104632195852395068257558557571275342262842546393663605590179427398640910127514327052638488269826429404589326287069495846260813832513336590386573068503445568815173822731830996760308753371650276620668074460965923771984617499691147766573324349983001863197854308206735199248325589349950165862136011675173576714713336923429359285624327567568406006449652642838650245939970923192786324714079134957524812057740099364145728525549495504775453696938185772060932152361783806127341016183362126077400924838345194288049219907811824213855754654764165002009751581602"
        ]
      ]
    },
    "nonce": "977706351734180334927202"
  },
  "state": "offer_received",
  "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
  "credential_proposal_dict": {
    "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/propose-credential",
    "@id": "5ff08072-3400-4002-ba2a-b2d63fa0ba19",
    "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
    "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
    "comment": "string",
    "credential_proposal": {
      "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/credential-preview",
      "attributes": [
        {
          "name": "name",
          "value": "alice"
        },
        {
          "name": "date",
          "value": "08-2018"
        },
        {
          "name": "degree",
          "value": "maths"
        },
        {
          "name": "age",
          "value": "25"
        }
      ]
    }
  },
  "role": "holder",
  "credential_exchange_id": "585d064e-f3b0-4aca-8765-867c4d9ca4fd",
  "auto_issue": false,
  "auto_offer": false,
  "thread_id": "694baf77-4fd6-4e55-958e-d127454e2d26",
  "credential_definition_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
  "created_at": "2020-08-26 01:45:22.884566Z",
  "auto_remove": true,
  "updated_at": "2020-08-26 01:45:22.884566Z",
  "connection_id": "1209e5c7-f62d-486d-8242-1f9054edb551",
  "trace": false
}
```

<p></p>

* issue_credential State check 

    |  | Faber | Alice |
    | --- | --- | --- |
    | issue_credential state | **`offer_sent`** | **`offer_received`** |
<p></p>

* Next Step
<br> `/issue-credential/records/{cred_ex_id}/send-request` Faber에게 send request
<p></p>

* Ledger Transactions (Indy Node)

    
<br><br>


### STEP 3. Alice --> Faber : Faber에게 Credential Request를 요청한다. 

* Method and Resource

    `POST` `/issue-credential/records/{cred_ex_id}/send-request` send request.  

* Parameter

 Name | Description 
 --- | --- 
 cred_ex_id | Faber의 Credential offer로 부터 받은 `credential_exchange_id`
 
<p></p>

* Example

    * input <br>
    `credential_exchange_id`: "412de146-5833-4fcc-be92-dbf5d50ba8ab"

<p></p>
 
   * Response body
```json
{
  "initiator": "external",
  "credential_offer": {
    "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
    "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
    "key_correctness_proof": {
      "c": "3463285366096097786129141568913605545219935328983248399056642450653989015708",
      "xz_cap": "2156435992085141195304355154183203863089845854021318424499022392336865243688692057302909482720023495834702073088361890916122840670431178047835929829611993390203302843133181259690132294638300162614121697769368634189768854120738173439723594226861264872175339261848875411970910898341837820752346436364373531192136655177008411942372668401941695332807033823963769849927808053221157593980079803944993578674424570299145141161779824639243116104645988100070683676384331305227049466900308310967731275947115393934812802442376671012683818443728453322796095319749786251287360885746970984960326258055873871842421009484074526039822185567858544054167437327492571057285741123786278560194348431462522730865934",
      "xr_cap": [
        [
          "date",
          "64361899676791339851685248745784902380337936170464404822953058285320912128697720104954659823958477314424970570565179160802328430523685246844357360808328529069385786907148139607519911401719304017800868317832482552035687169890042769386612105961224271628979281234989183645437523364812314945489937064492061065473495108956420908328188426003118254064953870046372568469136133496903533692715155121651645510185788052552108783467207542888031078176809595884192230937384236205264203037786832149473399931710252353031834768200168550433227708768511986839415646813731687398595522924918260579882929695332079934325630076411249340620325018686667491128040840759590791875892498239333349119184853414563367749386080"
        ],
        [
          "master_secret",
          "57758980020326025908069841487884534897150916956949366950425931404585375709939254348573651816278007720536720176904400455848662923012130542787607130480933753737773497741218682069506339039035103907188554627743131124678560217216905085916119022480271693555004394233025092041755030710853731340823336071862836843523816553552314359407934883020634389621875902709813523533954905530528399385220514572524071495755840174452699845141764616847439245030380530505843087476916932612491870825361487128849871052932963451309471887149097976552486875216265025345183302240105085813743741674298967605499837711726001776562131271041881508199660713299149726396550354257783923816219781260861476172486234036043225928816640"
        ],
        [
          "age",
          "58244994491637067714559394147137024855939387441851436967050926493639474741008222576725413688107490467589881739933583301730711268702845749145288495021884158003818944638670629965254049646948179793550978929801428308096899998739225485032599101183006345499337064042075062477665835007614366373920000573066485633337418691595378631728786678141329570889993636187086927471316451360832816361450744937180869267302317943309769974473111281401477646025364853543734149415778056598400231642079049625682587366697170590640678863001480183092137539000773171341355471043390805292489073805654798603604433397335418099471137574479984440056041135360449811461867870137409083357749668374792724481814307989975597611855503"
        ],
        [
          "degree",
          "10261121300918485232883171219138364102745035394662318484553248676247944386794247169843748643619729634537314210977932713078478321434973436435580079541916446320120077885876279896160051138278797525262011036304470107207204733305213179844999873533217296491673229384690013976460861809965098708847327862385363280146217847262560843835216642860122302486164762469724837735515023956212445978460534404136751680072542982446415900998747260646066494126620616752541296372598961519435188337728291927352986051671072442700986800155164247816430896934401846120175427534504602608116398812965657401803452745608619220631366754225379286637850390579654473569063914715913134398892525665826264024216134417750114735195235"
        ],
        [
          "name",
          "72839154503524173467809293575026491898057315148644876607939528580314339830354540875760810569564273712993649853474615974411150602209216207947469104632195852395068257558557571275342262842546393663605590179427398640910127514327052638488269826429404589326287069495846260813832513336590386573068503445568815173822731830996760308753371650276620668074460965923771984617499691147766573324349983001863197854308206735199248325589349950165862136011675173576714713336923429359285624327567568406006449652642838650245939970923192786324714079134957524812057740099364145728525549495504775453696938185772060932152361783806127341016183362126077400924838345194288049219907811824213855754654764165002009751581602"
        ]
      ]
    },
    "nonce": "977706351734180334927202"
  },
  "state": "request_sent",
  "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
  "credential_proposal_dict": {
    "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/propose-credential",
    "@id": "5ff08072-3400-4002-ba2a-b2d63fa0ba19",
    "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
    "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
    "comment": "string",
    "credential_proposal": {
      "@type": "did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/issue-credential/1.0/credential-preview",
      "attributes": [
        {
          "name": "name",
          "value": "alice"
        },
        {
          "name": "date",
          "value": "08-2018"
        },
        {
          "name": "degree",
          "value": "maths"
        },
        {
          "name": "age",
          "value": "25"
        }
      ]
    }
  },
  "role": "holder",
  "credential_request_metadata": {
    "master_secret_blinding_data": {
      "v_prime": "27278914979227605264589796862326037941895887683931691424825826436573411273151825643441194061707952036151881025705317744964585342174404498858905941388601512649015843259709405783701790143830336967187526982789225816308309988695786330884650385281621517343331695085610112801096419327822100403138019193509753316203608257516447193898511924167873773700977273206352071890651164527217924133330068666554277760998011749189262692552915157419239328184710654067004616709827034209554050175082430151722286078576483770581972645484262574209844866145561266491514288494537031145528901356134400210715619019599977699328867904619278370206132755277298783177263120110",
      "vr_prime": "1AD3C18395619B617B25050E90490976A480F68D87063F428D31BA8B0D893DB4"
    },
    "nonce": "363915726043232891124113",
    "master_secret_name": "alice.agent"
  },
  "credential_exchange_id": "585d064e-f3b0-4aca-8765-867c4d9ca4fd",
  "auto_issue": false,
  "auto_offer": false,
  "thread_id": "694baf77-4fd6-4e55-958e-d127454e2d26",
  "credential_definition_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
  "created_at": "2020-08-26 01:45:22.884566Z",
  "auto_remove": true,
  "credential_request": {
    "prover_did": "Dxoppftzt951AgQK5Naqv",
    "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
    "blinded_ms": {
      "u": "30870557595978919362791451744084995691001294584233424418228595314803570839195971128679815078305078515953157135711367205072747823850424336729654457889116757553057120438007242812859489811896712621157943172363388223195254233143645560974855112270035804465395218469008587064384992567845148556866496699035676552559145203417880850102473076880397866778489171080444867031633026794425915497666345250933312903182598763850833269992405577181189638149260117595319495595236617209298364404888072880675080473749091038187654123726388560456048887807414948668570123863252829212523344455295154109345416941670095499576675362831396162242753",
      "ur": "1 022147C22DF630751190E26235831C17CB34973A8B7021E42C712E71FC4BB8F4 1 11D4E8478290A1EE362661EC061E9D9C8F70726EB4FD14C60E2B2467C5F96EC3 2 095E45DDF417D05FB10933FFC63D474548B7FFFF7888802F07FFFFFF7D07A8A8",
      "hidden_attributes": [
        "master_secret"
      ],
      "committed_attributes": {}
    },
    "blinded_ms_correctness_proof": {
      "c": "33764370351637006286605579253203642660811496935112207017835506285117245689501",
      "v_dash_cap": "921055388149459176409994336295030812736945000310281336246303180980660432763210872127517171881964844378118049090069465223276518950745575652792913641981426460671996371883294796346318866552492306611956081975709022607643163431439055922318689356393042885072120354676120204834611023521459477333461793218808516219682857100440098965881076600469823830547635795431996479191712809017031229430533640838219520622568316107354269965874650494854447151307336169636385467350163999719956424976203110620655201555254428266572960998066947021361863270876724436525015481333290980849210872819754032403387149534067057014109537498362468781739275763265795520750673569902974883656083990060868200832367603817194784346398825021822859238364540379031",
      "m_caps": {
        "master_secret": "25217737286570541072435901033507230778019813637042637492408176245632011286851798538871451786173540601858866327237478699306709441948948938286515247705392371492484567048380533225749"
      },
      "r_caps": {}
    },
    "nonce": "363915726043232891124113"
  },
  "updated_at": "2020-08-26 01:56:42.639866Z",
  "connection_id": "1209e5c7-f62d-486d-8242-1f9054edb551",
  "trace": false
}
```

<p></p>

* issue_credential State check 

    |  | Faber | Alice |
    | --- | --- | --- |
    | issue_credential state | `request_received`<br> --> **`credential_issued`**  | `request_sent` --> **`credential_received`** |
<p></p>

* Next Step
<br> Alice의 Wallet에서 credential 확인 
<p></p>

* Ledger Transactions (Indy Node)
\
    
<br><br>


### STEP 4. Alice : Alice의 Credential 확인 

* Method and Resource

    `GET` `/credentials` wallet의 credential을 모두 가져옴.   
    `GET` `/credential/{credential_id}` wallet의 특정 credential id(`referent`) 가져옴.  
* Parameter

 Name | Description 
 --- | --- 
 cout | Maximum number to retrieve
 start | Start index
 wql | (JSON) WQL query

<p></p>

* Example
 
   * Response body
```json
{
  "results": [
    {
      "referent": "e483bb21-0469-4255-b0ac-46770a5a8552",
      "attrs": {
        "date": "08-2018",
        "name": "alice",
        "age": "25",
        "degree": "maths"
      },
      "schema_id": "Th7MpTaRZVRYnPiabds81Y:2:degree_schema:24.8.1",
      "cred_def_id": "Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2",
      "rev_reg_id": "Th7MpTaRZVRYnPiabds81Y:4:Th7MpTaRZVRYnPiabds81Y:3:CL:2143:faber_college_2:CL_ACCUM:83584a6d-8d1e-4ba6-a091-b3b61f893465",
      "cred_rev_id": "1"
    }
  ]
}
```

<p></p>


* Next Step

* Ledger Transactions (Indy Node)

    
<br><br>